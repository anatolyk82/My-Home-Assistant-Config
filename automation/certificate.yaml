# https://www.home-assistant.io/docs/ecosystem/certificates/lets_encrypt/
# sensor.ssl_certificate_expiry

- alias: '[HASS Certificate] Notification on update'
  initial_state: 'on'
  trigger:
    platform: template
    value_template: >
      {{ states.sensor.ssl_certificate_expiry.state | int  <= 10 }}
  condition:
    condition: template
    value_template: >
      {{ states.sensor.ssl_certificate_expiry.state != "unknown" }}
  action:
    service: notify.pushover
    data_template:
      message: >
        Home Assistant's certificate expires in {{ states.sensor.ssl_certificate_expiry.state }} days.


- alias: '[HASS Certificate] Auto Renew'
  trigger:
  - platform: numeric_state
    entity_id: sensor.ssl_cert_expiry
    below: 20
  action:
  - service: shell_command.renew_ssl
